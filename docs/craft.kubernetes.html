---

title: Kubernetes


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/craft/craft.kubernetes.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/craft/craft.kubernetes.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Concepts">Concepts<a class="anchor-link" href="#Concepts"> </a></h2><h3 id="Pod">Pod<a class="anchor-link" href="#Pod"> </a></h3><ul>
<li>Abstraction over container. </li>
<li>Smallest unit of k8s. </li>
<li>Usually 1 app per pod</li>
<li>Each pod has its own IP address</li>
</ul>
<h3 id="Service">Service<a class="anchor-link" href="#Service"> </a></h3><ul>
<li>Permanent IP address</li>
<li>Loadbalancer</li>
<li>Lifecycle of pod and service not connected</li>
</ul>
<h3 id="ConfigMap">ConfigMap<a class="anchor-link" href="#ConfigMap"> </a></h3><ul>
<li>External configuration for application</li>
</ul>
<h3 id="Secret">Secret<a class="anchor-link" href="#Secret"> </a></h3><ul>
<li>Store for secret data</li>
</ul>
<h3 id="Deployment">Deployment<a class="anchor-link" href="#Deployment"> </a></h3><ul>
<li>Blueprint for stateless application pod</li>
</ul>
<h3 id="Stateful-set">Stateful set<a class="anchor-link" href="#Stateful-set"> </a></h3><ul>
<li>Blueprint for stateful app pod</li>
</ul>
<h3 id="Node">Node<a class="anchor-link" href="#Node"> </a></h3><ul>
<li><p>Worker nodes</p>
<ul>
<li>Each node has multiple pods on it</li>
<li>3 processess must be installed on each node<ul>
<li>Container runtime</li>
<li>Kubelet: for managing node and container</li>
<li>Kubeproxy: forwarding requests for a service to appropriate pod</li>
</ul>
</li>
</ul>
</li>
<li><p>Master node</p>
<ul>
<li>4 processes run on every master node<ul>
<li>API Server: cluster gateway</li>
<li>Controller manager: detects cluster state changes</li>
<li>Scheduler: schedule worker nodes</li>
<li>etcd: key-value store for cluster state</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Ports">Ports<a class="anchor-link" href="#Ports"> </a></h3><ul>
<li>targetPort: The target port on the pod(s) to forward traffic to, same as <code>containerPort</code></li>
<li>port: The port of this <code>service</code></li>
<li>nodePort: The port on the node where external traffic will come in on, in range [30000, 32767]</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Commands">Commands<a class="anchor-link" href="#Commands"> </a></h2><h3 id="Install-hyperhit-and-minikube">Install hyperhit and minikube<a class="anchor-link" href="#Install-hyperhit-and-minikube"> </a></h3><p><code>brew update</code></p>
<p><code>brew install hyperkit</code></p>
<p><code>brew install minikube</code></p>
<p><code>kubectl</code></p>
<p><code>minikube</code></p>
<h3 id="Create-minikube-cluster">Create minikube cluster<a class="anchor-link" href="#Create-minikube-cluster"> </a></h3><p><code>minikube start --vm-driver=hyperkit</code></p>
<p><code>kubectl get nodes</code></p>
<p><code>minikube status</code></p>
<p><code>kubectl version</code></p>
<p>assign public IP address to service
<code>minikube service $service_name</code></p>
<h3 id="Delete-cluster-and-restart-in-debug-mode">Delete cluster and restart in debug mode<a class="anchor-link" href="#Delete-cluster-and-restart-in-debug-mode"> </a></h3><p><code>minikube delete</code></p>
<p><code>minikube start --vm-driver=hyperkit --v=7 --alsologtostderr</code></p>
<p><code>minikube status</code></p>
<h3 id="kubectl-commands">kubectl commands<a class="anchor-link" href="#kubectl-commands"> </a></h3><p><code>kubectl get nodes</code></p>
<p><code>kubectl get pod</code></p>
<p><code>kubectl get services</code></p>
<p><code>kubectl create deployment nginx-depl --image=nginx</code></p>
<p><code>kubectl get deployment</code></p>
<p><code>kubectl get replicaset</code></p>
<p><code>kubectl edit deployment nginx-depl</code></p>
<h3 id="Debugging">Debugging<a class="anchor-link" href="#Debugging"> </a></h3><p><code>kubectl logs {pod-name}</code></p>
<p><code>kubectl exec -it {pod-name} -- bin/bash</code></p>
<h3 id="Create-mongo-deployment">Create mongo deployment<a class="anchor-link" href="#Create-mongo-deployment"> </a></h3><p><code>kubectl create deployment mongo-depl --image=mongo</code></p>
<p><code>kubectl logs mongo-depl-{pod-name}</code></p>
<p><code>kubectl describe pod mongo-depl-{pod-name}</code></p>
<h3 id="Delete-deplyoment">Delete deplyoment<a class="anchor-link" href="#Delete-deplyoment"> </a></h3><p><code>kubectl delete deployment mongo-depl</code></p>
<p><code>kubectl delete deployment nginx-depl</code></p>
<h3 id="Create-or-edit-config-file">Create or edit config file<a class="anchor-link" href="#Create-or-edit-config-file"> </a></h3><p><code>vim nginx-deployment.yaml</code></p>
<p><code>kubectl apply -f nginx-deployment.yaml</code></p>
<p><code>kubectl get pod</code></p>
<p><code>kubectl get deployment</code></p>
<h3 id="Delete-with-config">Delete with config<a class="anchor-link" href="#Delete-with-config"> </a></h3><p><code>kubectl delete -f nginx-deployment.yaml</code></p>
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3><p><code>kubectl top</code> command returns current CPU and memory usage for a clusterâ€™s pods or nodes, or for a particular pod or node if specified.</p>

</div>
</div>
</div>
</div>
 

