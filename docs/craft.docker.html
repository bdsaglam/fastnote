---

title: docker


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/craft/craft.docker.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/craft/craft.docker.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Commands">Commands<a class="anchor-link" href="#Commands"> </a></h2><h3 id="Image-commands">Image commands<a class="anchor-link" href="#Image-commands"> </a></h3><div class="highlight"><pre><span></span>docker image ls

docker image rm &lt;image-id&gt;

docker tag &lt;image&gt; &lt;username/repository:tag&gt;
</pre></div>
<ul>
<li>Build image</li>
</ul>
<div class="highlight"><pre><span></span>docker build --tag &lt;image_name&gt;:&lt;tag&gt; &lt;folder of DOCKERFILE&gt;
</pre></div>
<ul>
<li>Build image behind firewall</li>
</ul>
<div class="highlight"><pre><span></span>docker build --network<span class="o">=</span>host -t &lt;image-name&gt; .
</pre></div>
<ul>
<li>Run an image</li>
</ul>
<div class="highlight"><pre><span></span>docker run -it --rm <span class="se">\</span>

    -p &lt;host-port&gt;:&lt;container-port&gt; <span class="se">\ </span>

    -v &lt;host-directory&gt;:&lt;container-directory&gt;  <span class="se">\</span>

    --name &lt;container-name&gt; <span class="se">\</span>

    &lt;image&gt; &lt;command&gt;
</pre></div>
<ul>
<li>Delete all images</li>
</ul>
<div class="highlight"><pre><span></span>docker rmi <span class="k">$(</span>docker images -q<span class="k">)</span>
</pre></div>
<ul>
<li>Push image to docker hub</li>
</ul>
<div class="highlight"><pre><span></span>docker tag &lt;local-image&gt;:&lt;tag&gt; &lt;new-repo&gt;:&lt;tag&gt;

docker push &lt;new-repo&gt;:&lt;tag&gt;
</pre></div>
<h3 id="Container-commands">Container commands<a class="anchor-link" href="#Container-commands"> </a></h3><div class="highlight"><pre><span></span>docker container ls -a 

docker ps -a

docker container start &lt;container-id&gt;

docker container start -ia &lt;container-id&gt;

docker container stop &lt;container-id&gt;

docker container rm &lt;container-id&gt;
</pre></div>
<ul>
<li>Kill and delete all containers</li>
</ul>
<div class="highlight"><pre><span></span>docker rm <span class="k">$(</span>docker ps -a -q<span class="k">)</span>

docker <span class="nb">kill</span> <span class="k">$(</span>docker ps -q<span class="k">)</span>
</pre></div>
<ul>
<li>Delete all stopped containers</li>
</ul>
<div class="highlight"><pre><span></span>docker rm <span class="k">$(</span>docker ps -a -q<span class="k">)</span>
</pre></div>
<ul>
<li>Start existing container with bash</li>
</ul>
<div class="highlight"><pre><span></span>docker container start &lt;container_id&gt;

docker <span class="nb">exec</span> -it &lt;container_id&gt; bash
</pre></div>
<ul>
<li>Start jupyter notebook in container</li>
</ul>
<div class="highlight"><pre><span></span>jupyter notebook --ip <span class="m">0</span>.0.0.0 --allow-root --no-browser
</pre></div>
<ul>
<li>Clean up</li>
</ul>
<div class="highlight"><pre><span></span>docker system prune -a
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Docker-for-data-science">Docker for data science<a class="anchor-link" href="#Docker-for-data-science"> </a></h2><p><a href="https://www.youtube.com/watch?v=oO8n3y23b6M&amp;ab_channel=ChicagoPythonUsersGroup">Docker for data science projects</a></p>
<p>Docker client communicates with docker daemon which is responsible of managing containers and images.
A Docker container instance is a read-write container layer put on top of read-only image layers.</p>
<h3 id="Jupyter-notebook-in-Docker-container">Jupyter notebook in Docker container<a class="anchor-link" href="#Jupyter-notebook-in-Docker-container"> </a></h3><div class="highlight"><pre><span></span><span class="k">FROM</span> <span class="s">python:3.9-slim-buster</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>
<span class="k">COPY</span> . /app

<span class="k">VOLUME</span><span class="s"> /shared_dir</span>

<span class="k">EXPOSE</span><span class="s"> 8888</span>

<span class="k">RUN</span> pip install --no-cache-dir jupyter 

<span class="k">CMD</span> jupyter notebook --ip<span class="o">=</span><span class="s1">&#39;*&#39;</span> --port<span class="o">=</span><span class="m">8888</span> --no-browser --allow-root
</pre></div>
<p>Then, build image and start container:</p>
<div class="highlight"><pre><span></span>docker build -t data-science-image
docker run -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">/host_dir&quot;</span>:/shared_dir -p <span class="m">9999</span>:8888 -it data-science-image
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resources">Resources<a class="anchor-link" href="#Resources"> </a></h2><ul>
<li><p><a href="https://notes.hamel.dev/docs/docker/Docker-In-Action.html#injecting-environment-variables">Hamel's notes</a></p>
</li>
<li><p><a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices/">Dockerfile best practices</a></p>
</li>
<li><p><a href="https://docs.docker.com/develop/dev-best-practices/">Docker development best practices</a></p>
</li>
</ul>

</div>
</div>
</div>
</div>
 

